function C = RRR_coriolis_matrix(q,dq)
q1 = q(1);
q2 = q(2);
q3 = q(3);
dq1 = dq(1);
dq2 = dq(2);
dq3 = dq(3);

%parameters
a1 = 1;
a2 = 1;
a3 = 1;

m1 = 1;
m2 = 1;
m3 = 1;

l1 = a1/2;
l2 = a2/2;
l3 = a3/2;

Ixx1 = 1/12*m1*a1^2;
Iyy1 = Ixx1;
Izz1 = Ixx1;

Ixx2 = 1/12*m2*a2^2;
Iyy2 = Ixx2;
Izz2 = Ixx2;

Ixx3 = 1/12*m3*a3^2;
Iyy3 = Ixx3;
Izz3 = Ixx3;

c11 = - dq3*sin(q3)*(Iyy3*cos(q3) - Ixx3*cos(q3) + l3^2*m3*cos(q3) + a2*l3*m3 + a1*l3*m3*cos(q2)) - a1*dq2*sin(q2)*(a2*m3 + l2*m2 + l3*m3*cos(q3));
c12 = (Ixx3*dq3*sin(2*q3))/2 - (Iyy3*dq3*sin(2*q3))/2 - (dq3*l3^2*m3*sin(2*q3))/2 - a1*a2*dq1*m3*sin(q2) - a1*a2*dq2*m3*sin(q2) - a1*dq1*l2*m2*sin(q2) - a1*dq2*l2*m2*sin(q2) - a2*dq3*l3*m3*sin(q3) - a1*dq1*l3*m3*cos(q3)*sin(q2) - a1*dq2*l3*m3*cos(q3)*sin(q2) - a1*dq3*l3*m3*cos(q2)*sin(q3);
c13 = 0;
c21 = (Ixx3*dq3*sin(2*q3))/2 - (Iyy3*dq3*sin(2*q3))/2 - (dq3*l3^2*m3*sin(2*q3))/2 + a1*a2*dq1*m3*sin(q2) + a1*dq1*l2*m2*sin(q2) - a2*dq3*l3*m3*sin(q3) + a1*dq1*l3*m3*cos(q3)*sin(q2);
c22 = -dq3*((m3*sin(2*q3)*l3^2)/2 + a2*m3*sin(q3)*l3 - (Ixx3*sin(2*q3))/2 + (Iyy3*sin(2*q3))/2);
c23 = 0;
c31 = 0;
c32 = 0;
c33 = 0;

C = [c11 c12 c13 ; c21 c22 c23 ; c31 c32 c33];
% c11 = - dq3*((cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2))/2) - dq2*((sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2) - (cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2) + (sin(q1 + q2)*(cos(q1 + q2)/2 + cos(q1)))/2 - (cos(q1 + q2)*(sin(q1 + q2)/2 + sin(q1)))/2);
% c12 = - dq3*((cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2))/2) - dq1*((sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2) - (cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2) + (sin(q1 + q2)*(cos(q1 + q2)/2 + cos(q1)))/2 - (cos(q1 + q2)*(sin(q1 + q2)/2 + sin(q1)))/2) - dq2*((sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2) - (cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2) + (sin(q1 + q2)*(cos(q1 + q2)/2 + cos(q1)))/2 - (cos(q1 + q2)*(sin(q1 + q2)/2 + sin(q1)))/2);
% c13 = - dq3*((cos(q1 + q2)*(sin(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (sin(q1 + q2)*(cos(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + cos(q1 + q2)*((cos(q1 + q2)*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q3)^2)/12 - (sin(q1 + q2)*cos(q3)^2)/12 + (sin(q1 + q2)*sin(q3)^2)/12) - (cos(q1 + q2)*(cos(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + sin(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + (sin(q1 + q2)*(cos(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + cos(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + (sin(q1 + q2)*cos(q3)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2))/2 - (cos(q1 + q2)*cos(q3)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2))/2) - dq1*((cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2))/2) - dq2*((cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2))/2);
% c21 = dq1*((sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2) - (cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2) + (sin(q1 + q2)*(cos(q1 + q2)/2 + cos(q1)))/2 - (cos(q1 + q2)*(sin(q1 + q2)/2 + sin(q1)))/2) - dq3*((cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2))/2);
% c22 = -dq3*((cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2))/2);
% c23 = - dq3*((cos(q1 + q2)*(sin(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (sin(q1 + q2)*(cos(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + cos(q1 + q2)*((cos(q1 + q2)*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q3)^2)/12 - (sin(q1 + q2)*cos(q3)^2)/12 + (sin(q1 + q2)*sin(q3)^2)/12) - (cos(q1 + q2)*(cos(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + sin(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + (sin(q1 + q2)*(cos(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + cos(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + (sin(q1 + q2)*cos(q3)*(cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2))/2 - (cos(q1 + q2)*cos(q3)*(sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2))/2) - dq1*((cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2))/2) - dq2*((cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2))/2);
% c31 = dq3*((cos(q1 + q2)*(sin(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (sin(q1 + q2)*(cos(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (cos(q1 + q2)*(cos(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + sin(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + (sin(q1 + q2)*(cos(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + cos(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2) + dq1*(cos(q1 + q2)*((cos(q1 + q2)*cos(q3)*sin(q3))/12 + (sin(q1 + q2)*cos(q3)*sin(q3))/12) + sin(q1 + q2)*((cos(q1 + q2)*cos(q3)*sin(q3))/12 - (sin(q1 + q2)*cos(q3)*sin(q3))/12) + (cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + cos(q1) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + sin(q1) + (sin(q1 + q2)*cos(q3))/2))/2) + dq2*(cos(q1 + q2)*((cos(q1 + q2)*cos(q3)*sin(q3))/12 + (sin(q1 + q2)*cos(q3)*sin(q3))/12) + sin(q1 + q2)*((cos(q1 + q2)*cos(q3)*sin(q3))/12 - (sin(q1 + q2)*cos(q3)*sin(q3))/12) + (cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2))/2);
% c32 = dq3*((cos(q1 + q2)*(sin(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (sin(q1 + q2)*(cos(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (cos(q1 + q2)*(cos(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + sin(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + (sin(q1 + q2)*(cos(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + cos(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2) + dq1*(cos(q1 + q2)*((cos(q1 + q2)*cos(q3)*sin(q3))/12 + (sin(q1 + q2)*cos(q3)*sin(q3))/12) + sin(q1 + q2)*((cos(q1 + q2)*cos(q3)*sin(q3))/12 - (sin(q1 + q2)*cos(q3)*sin(q3))/12) + (cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2))/2) + dq2*(cos(q1 + q2)*((cos(q1 + q2)*cos(q3)*sin(q3))/12 + (sin(q1 + q2)*cos(q3)*sin(q3))/12) + sin(q1 + q2)*((cos(q1 + q2)*cos(q3)*sin(q3))/12 - (sin(q1 + q2)*cos(q3)*sin(q3))/12) + (cos(q1 + q2)*sin(q3)*(cos(q1 + q2) + (cos(q1 + q2)*cos(q3))/2))/2 + (sin(q1 + q2)*sin(q3)*(sin(q1 + q2) + (sin(q1 + q2)*cos(q3))/2))/2);
% c33 = dq3*((cos(q1 + q2)*(sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)*sin(q3))/6 - (cos(q1 + q2)*sin(q1 + q2)*cos(q3)*sin(q3))/6) - cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)*sin(q3))/6 - (sin(q1 + q2)^2*cos(q3)*sin(q3))/6)))/2 - ((cos(q1 + q2)^2*cos(q3))/2 + (sin(q1 + q2)^2*cos(q3))/2)*((cos(q1 + q2)^2*sin(q3))/2 + (sin(q1 + q2)^2*sin(q3))/2) + (cos(q1 + q2)^2*cos(q3)*sin(q3))/4 + (sin(q1 + q2)^2*cos(q3)*sin(q3))/4 + (cos(q1 + q2)*sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)*sin(q3))/6 - (cos(q1 + q2)*sin(q1 + q2)*cos(q3)*sin(q3))/6))/2) + dq1*((cos(q1 + q2)*(sin(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (sin(q1 + q2)*(cos(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (cos(q1 + q2)*(cos(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + sin(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + (sin(q1 + q2)*(cos(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + cos(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2) + dq2*((cos(q1 + q2)*(sin(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (sin(q1 + q2)*(cos(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 - (cos(q1 + q2)*(cos(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + sin(q1 + q2)*(cos(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + cos(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2 + (sin(q1 + q2)*(cos(q1 + q2)*(sin(q1 + q2)^2/12 + (cos(q1 + q2)^2*cos(q3)^2)/12 + (cos(q1 + q2)^2*sin(q3)^2)/12) - sin(q1 + q2)*((cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6 - (cos(q1 + q2)*sin(q1 + q2))/6 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/6) + cos(q1 + q2)*(cos(q1 + q2)^2/12 - sin(q1 + q2)^2/12 - (cos(q1 + q2)^2*sin(q3)^2)/12 + (sin(q1 + q2)^2*sin(q3)^2)/12 + (cos(q1 + q2)*sin(q1 + q2)*cos(q3)^2)/6) + sin(q1 + q2)*((cos(q1 + q2)^2*cos(q3)^2)/12 - (cos(q1 + q2)*sin(q1 + q2))/12 + (cos(q1 + q2)*sin(q1 + q2)*sin(q3)^2)/12)))/2);
% C = [c11 c12 c13;c21 c22 c23;c31 c32 c33];

